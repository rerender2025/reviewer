# Reviewer

这是一个本地运行的 AI 审稿工具，能够逐段分析论文内容，提供评审意见的同时包含原文引用。

## 安装

```bash
python -m virtualenv .venv --python=python3.12.9
python -m pip install -r requirements.txt
```

## 使用

- 本地安装 ollama，并且使用 `ollama serve` 启动了它，模型默认使用 `qwen3:30b-a3b-instruct-2507-q4_K_M`
- 运行 `python ./main.py`，预期将在 `out/analysis_results_json` 生成对论文的逐段分析，格式是json，例如 `page_008_item_02.json`：

```json
{
  "type": "数据时间线逻辑错误",
  "comment": "文中提到2001年《离婚法》出台与宣传，导致2010年家暴占比降至8.8%，但《离婚法》并非2001年出台，中国现行《婚姻法》（后修订为《民法典》婚姻家庭编）并未在2001年以‘离婚法’名义出台，且2001年修订的是《婚姻法》，并非新立法律。此外，2010年数据与2001年法律出台之间缺乏明确因果关系，时间逻辑不成立。",
  "ref": [
    "2001年随着《离婚法》的出台与宣传，2010年的调查数据显示我国妇女遭受家庭暴力的占比降至$8.8\\%$"
  ],
  "page_index": 8,
  "bbox": []
}
```

以上是本工具的最简 Demo，如果想要更换论文，需要先使用 [MinerU](https://mineru.net/) 将 pdf 格式的论文转换为 markdown，然后将输出结果中的 `layout.json` 替换 `assets/layout.json`。

## 原理

- 首先程序从 `layout.json` 中按页分割原论文，输出到 `output_md_pages` 目录
- 然后开始分析，prompt 中特别要求了将分析结果输出为json，且包含对原文的引用，所以在`analysis_results_json`目录下的每个json，都是逐段分析的结果，且包含原文引用
- 分析结束后，根据原文引用文本，在`layout.json`中匹配并找到对应论文 pdf 图片的 bbox，然后加入到分析结果json中。bbox字段可供下游使用，比如在原论文图片对应区域加上半透明蓝色矩形，方便快速对照评审意见和论文内容

## 局限性

- 受限于 OCR 精度，有的内容会识别错误，进而导致分析错误
- 受限于按页分割的方式，由于缺少前一页的内容，分析也会出现误报的情况
- 受限于 AI 模型没有联网查询，涉及具体数据的，可能不准确。AI 模型本身分析也可能存在问题。

注意：评审意见由 AI 生成，且无法保证 100% 正确，如果要发布至公共平台，需要人工校对！

## 优势

- 完全本地的 AI 审稿工具, 由于是逐段分析，AI 乱说的情况极少，且分析结果包含原文引用
- 经过实际测试，能很好地发现常见的问题：语病、错别字、逻辑问题、常识问题、术语准确性、伦理问题